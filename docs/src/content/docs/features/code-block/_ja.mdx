import { defineDocsMetadata } from "@/lib/docs/content-module"

export const metadata = defineDocsMetadata({
  title: "Code Blocks (JA)",
})

# Code Block

## 基本

コードブロックは、バッククォート3つ（```` ``` ````）で囲むことで作成できます。

````mdx
```ts
const greet = (name: string): string => {
  return `Hello, ${name}!`;
};

console.log(greet("World")); // Output: Hello, World!
```
````

## 拡張機能

以下に、Mercury のコードブロックで使用できる拡張機能を紹介します。

なお、これらは全て組み合わせて使用できます。

例えば、`title` と `showLineNumbers` を同時に指定することも可能です：

````mdx
```ts title="greet.ts" showLineNumbers
const greet = (name: string): string => {
  return `Hello, ${name}!`;
};

console.log(greet("World")); // Output: Hello, World!
```
````

### 行番号の表示

コードブロックに `showLineNumbers` メタデータを追加することで、行番号を表示できます。

````mdx
```ts showLineNumbers
const greet = (name: string): string => {
  return `Hello, ${name}!`;
};

console.log(greet("World")); // Output: Hello, World!
```
````

### タイトル

コードブロックに `title="your title"` メタデータを追加することで、タイトルを表示できます。

ファイル名を表示したい際などに便利です。

````mdx
```ts title="greet.ts"
const greet = (name: string): string => {
  return `Hello, ${name}!`;
};

console.log(greet("World")); // Output: Hello, World!
```
````

### 行ハイライト

コードブロックに `{1,4-7}` のようなメタデータを追加することで、指定した行をハイライトできます。

次の例では、2行目と5〜7行目がハイライトされます。

````mdx
```ts {2,5-7}
const greet = (name: string): string => {
  return `Hello, ${name}!`;
};

for (const name of ["World", "Mercury", "MDX"]) {
  console.log(greet(name)); // Output: Hello, <name>!
}
```
````

また、`[!code highlight]` をコメントアウト内に記述することでも、その行をハイライトできます。

````mdx
```ts
const greet = (name: string): string => {
  return `Hello, ${name}!`; // [\!code highlight]
};
```
````

`[!code highlight:3]` のように指定することで、複数行のハイライトも可能です。

````mdx
```ts
// [\!code highlight:3]
const greet = (name: string): string => {
  return `Hello, ${name}!`;
};
```
````

詳しくは以下を参照してください。

https://shiki.style/packages/transformers#transformermetahighlight

https://shiki.style/packages/transformers#transformernotationhighlight

### 単語ハイライト

コードブロックに `/word/` のようにメタデータを追加することで、指定した単語をハイライトできます。

````mdx
```ts /string/
const greet = (name: string): string => {
  return `Hello, ${name}!`;
};
```
````

また、`[!code word:word]` をコメントアウト内に記述することでも、その単語をハイライトできます。

````mdx
```ts
// [\!code word:string]
const greet = (name: string): string => {
  return `Hello, ${name}!`;
};
```
````

詳しくは以下を参照してください。

https://shiki.style/packages/transformers#transformermetawordhighlight

https://shiki.style/packages/transformers#transformernotationwordhighlight

### 差分比較

コードブロックに `diff` メタデータを追加することで、差分の表示が可能です。

`-` で始まる行は削除、`+` で始まる行は追加として表示されます。

````mdx
```ts diff
  const greet = (name: string): string => {
-   return `Hello, ${name}!`;
+   return `Hi, ${name}!`;
  };
```
````

また、`[!code --]` と `[!code ++]` をコメントアウト内に記述することでも、差分の表示が可能です。

````mdx
```ts
const greet = (name: string): string => {
  return `Hello, ${name}!`; // [\!code --]
  return `Hi, ${name}!`; // [\!code ++]
};
```
````

詳しくは以下を参照してください。

https://shiki.style/packages/transformers#transformernotationdiff

## Syntax Highlighting 対応言語

Mercury では Syntax Highlighting に [Shiki](https://shiki.style/) を使用しています。

対応している言語の一覧については次のページを参照してください。

https://shiki.style/languages

## オプション

Shiki のオプションは `mdx.rehypeShiki` プロパティで指定できます。

```ts title="vite.config.ts" {11-17}
import mercury from "@mercurymd/vite-plugin";
import tailwindcss from "@tailwindcss/vite";
import react from "@vitejs/plugin-react";
import { defineConfig } from "vite";

// https://vitejs.dev/config/
export default defineConfig({
  plugins: [
    mercury({
      mdx: {
        rehypeShiki: {
          // write your options here...
          themes: {
            light: "github-light",
            dark: "one-dark-pro",
          },
        }
      },
    }),
    react({ include: /\.(mdx|js|jsx|ts|tsx)$/ }),
    tailwindcss(),
  ],
});
```

詳しくは次のページを参照してください。

https://shiki.style/packages/rehype
